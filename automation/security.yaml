- alias: Arm alarm (tracking)
  trigger:
    platform: state
    entity_id: group.residents
    state: not_home
  action:
    - service: alarm_control_panel.alarm_arm_away
      entity_id: alarm_control_panel.house
      data:
        code: !secret alarm_code

- alias: Arm alarm (away)
  trigger:
    platform: state
    entity_id: switch.away
    state: "on"
  action:
    - service: alarm_control_panel.alarm_arm_away
      entity_id: alarm_control_panel.house
      data:
        code: !secret alarm_code

- alias: Disarm alarm (tracking)
  trigger:
    platform: state
    entity_id: group.residents
    state: home
  action:
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.house
      data:
        code: !secret alarm_code

- alias: Disarm alarm (away)
  trigger:
    platform: state
    entity_id: switch.away
    state: "off"
  action:
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.house
      data:
        code: !secret alarm_code

- alias: Arming started
  trigger:
    platform: state
    entity_id: alarm_control_panel.house
    state: pending
  action:
    - service: script.turn_on
      entity_id: script.notify
      data:
        variables:
          message: "Activating security alarm"

- alias: Arming set
  trigger:
    platform: state
    entity_id: alarm_control_panel.house
    state: armed_away
  action:
    - service: script.turn_on
      entity_id: script.notify
      data:
        variables:
          message: "Security alarm has been set"

- alias: Disarm start
  trigger:
    platform: state
    entity_id: alarm_control_panel.house
    state: disarmed
  action:
    - service: script.turn_on
      entity_id: script.notify
      data:
        variables:
          message: "Security alarm has been disabled"

- alias: Trigger alarm if motion downstairs
  trigger:
    platform: state
    entity_id: sensor.aeotec_zw100_multisensor_6_burglar_2_10
    from: "0"
    to: "8"
  condition:
    - condition: state
      entity_id: alarm_control_panel.house
      state: armed_away
  action:
    - service: script.turn_on
      entity_id: script.notify
      data:
        variables:
          message: "Unauthorised entry to this house has been detected. The residents have been informed. Please leave the property now."
    - service: alarm_control_panel.alarm_trigger
      entity_id: alarm_control_panel.house

